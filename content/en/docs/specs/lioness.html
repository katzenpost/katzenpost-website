---
title: 
linkTitle: "LIONESS wide-block cipher" 
description: "" 
url: "docs/specs/lioness.html" 
date: "2025-01-03T12:29:59.99939766-08:00"
draft: false 
slug: "" 
layout: "" 
type: "" 
weight: 1 
---
<!DOCTYPE HTML>
<html xmlns:ng="http://docbook.org/docbook-ng">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
      <title>LIONESS wide-block cipher</title>
      <meta name="generator" content="DocBook XSL Stylesheets V1.79.2">
      <meta name="description" content="This document defines the LIONESS Wide-Block-Cipher construct, and provides a concrete parameterization based around the BLAKE2b hash algorithm and ChaCha20 stream cipher. This document does not introduce any new crypto, but is meant to serve as a stable reference and implementation guide.">
   </head>
   <body>
      <div class="article">
         <div class="titlepage">
            <div>
               <div>
                  <h1 class="title"><a name="lioness"></a>LIONESS wide-block cipher</h1>
               </div>
               <div>
                  <div class="authorgroup">
                     <div class="author">
                        <h3 class="author"><span class="firstname">Yawning</span> <span class="surname">Angel</span></h3>
                     </div>
                  </div>
               </div>
               <div>
                  <div class="abstract">
                     <p class="title"><b>Abstract</b></p>
                     <p>This document defines the LIONESS Wide-Block-Cipher construct, and provides a
                        concrete parameterization based around the BLAKE2b hash algorithm and ChaCha20
                        stream cipher.</p>
                     <p>This document does not introduce any new crypto, but is meant to serve as a stable
                        reference and implementation guide.</p>
                  </div>
               </div>
            </div>
            <hr>
         </div>
         <div class="toc">
            <p><b>Table of Contents</b></p>
            <dl class="toc">
               <dt><span class="section"><a href="#lioness_introduction">1. Introduction</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="section"><a href="#conventions-used-in-this-document">1.1 Conventions Used in This Document</a></span></dt>
                  </dl>
               </dd>
               <dt><span class="section"><a href="#the-lioness-wide-block-cipher-construct">2. The LIONESS Wide-Block-Cipher Construct</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="section"><a href="#lioness-encryption">2.1 LIONESS Encryption</a></span></dt>
                     <dt><span class="section"><a href="#lioness-decryption">2.2 LIONESS Decryption</a></span></dt>
                  </dl>
               </dd>
               <dt><span class="section"><a href="#lioness-blake2b-chacha20">3. LIONESS-BLAKE2b-ChaCha20</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="section"><a href="#lioness-blake2b-chacha20-encryption">3.1 LIONESS-BLAKE2b-ChaCha20 Encryption</a></span></dt>
                     <dt><span class="section"><a href="#lioness-blake2b-chacha20-decryption">3.2 LIONESS-BLAKE2b-ChaCha20 Decryption</a></span></dt>
                  </dl>
               </dd>
               <dt><span class="section"><a href="#implementation-considerations">4. Implementation Considerations</a></span></dt>
               <dt><span class="section"><a href="#security-considerations">5. Security Considerations</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="section"><a href="#appendix-a.-references">Appendix A. References</a></span></dt>
                  </dl>
               </dd>
            </dl>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both"><a name="lioness_introduction"></a>1. Introduction</h2>
                  </div>
               </div>
            </div>
            <p> LIONESS is a provably secure wide-block-cipher proposed by Anderson and Biham in
               <a class="link" href="#AB96">[AB96]</a>. Internally it is a four round
               unbalanced Feistel cipher comprised of a keyed hash function and a stream cipher.
               It
               supports processing large abitrary sized blocks, with a minimum block size imposed
               by
               the choice of primitives, and has the property such that each bit of the ciphertext
               is
               dependent on every single bit of the plaintext and vice versa. </p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="conventions-used-in-this-document"></a>1.1 Conventions Used in This Document</h3>
                     </div>
                  </div>
               </div>
               <p> The key words <span class="quote">&#x201c;<span class="quote">MUST</span>&#x201d;</span>, <span class="quote">&#x201c;<span class="quote">MUST NOT</span>&#x201d;</span>,
                  <span class="quote">&#x201c;<span class="quote">REQUIRED</span>&#x201d;</span>, <span class="quote">&#x201c;<span class="quote">SHALL</span>&#x201d;</span>, <span class="quote">&#x201c;<span class="quote">SHALL
                        NOT",</span>&#x201d;</span>SHOULD&#x201d;, <span class="quote">&#x201c;<span class="quote">SHOULD NOT</span>&#x201d;</span>, <span class="quote">&#x201c;<span class="quote">RECOMMENDED</span>&#x201d;</span>,
                  <span class="quote">&#x201c;<span class="quote">MAY</span>&#x201d;</span>, and <span class="quote">&#x201c;<span class="quote">OPTIONAL</span>&#x201d;</span> in this document are to be
                  interpreted as described in <a class="link" href="#RFC2119">RFC2119</a>. </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist compact" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p><code class="literal">x | y</code> is the concatenation of x and y </p>
                     </li>
                     <li class="listitem">
                        <p><code class="literal">x ^ y</code> is the bitwise XOR of x and y </p>
                     </li>
                     <li class="listitem">
                        <p> A <code class="literal">byte</code> is an 8-bit octet </p>
                     </li>
                  </ul>
               </div>
               <p><code class="literal">x[a:b]</code> is the sub-vector of x where a/b denote the start/end byte
                  indexes (inclusive-exclusive). a/b may be omitted to signify the start/end of the
                  vector x respectively. </p>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both"><a name="the-lioness-wide-block-cipher-construct"></a>2. The LIONESS Wide-Block-Cipher Construct</h2>
                  </div>
               </div>
            </div>
            <p> LIONESS is parameteriezed with a keyed hash function (MAC) and a stream cipher as
               follows. </p>
            <p><code class="literal">H(k, m)</code> is a keyed hash function (MAC) with the key
               <code class="literal">k</code>, for a message <code class="literal">m</code> of arbitrary size. Let
               <code class="literal">HashLength</code> denote the size of the output and the key in bytes. </p>
            <p><code class="literal">H()</code> MUST be collision resistant or preimage resistant, and
               implementations SHOULD pick algorithms that provide both properties. </p>
            <p><code class="literal">S(k)</code> is a pseudo random function (stream cipher) which given the
               <code class="literal">HashLength</code> sized input <code class="literal">k</code> will generate an
               output of arbitrary size. </p>
            <p><code class="literal">S()</code> MUST be key recovery resistant. </p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="lioness-encryption"></a>2.1 LIONESS Encryption</h3>
                     </div>
                  </div>
               </div>
               <pre class="programlisting">
LIONESS-Encrypt(k1, k2, k3, k4, plaintext) -&gt; ciphertext
</pre>
               <p> Inputs: </p>
               <p><code class="literal">k1,k2,k3,k4</code> Round keys, each HashLength bytes in size. </p>
               <p><code class="literal">plaintext</code> The plaintext to encrypt, greater than
                  <code class="literal">HashLength</code> bytes in size. </p>
               <p> Output: </p>
               <p><code class="literal">ciphertext</code> The resulting ciphertext. </p>
               <p> The output of LIONESS-Encrypt is calculated as follows: </p>
               <pre class="programlisting">
L = plaintext[0:HashLength]
R = plaintext[HashLength:]
R = R ^ S(L ^ k1)
L = L ^ H(k2, R)
R = R ^ S(L ^ k3)
L = L ^ H(k4, R)
ciphertext = L | R
</pre>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="lioness-decryption"></a>2.2 LIONESS Decryption</h3>
                     </div>
                  </div>
               </div>
               <pre class="programlisting">
LIONESS-Decrypt(k1, k2, k3, k4, ciphertext) -&gt; plaintext
</pre>
               <p> Inputs: </p>
               <p><code class="literal">k1,k2,k3,k4</code> Round keys, each <code class="literal">HashLength</code> bytes
                  in size. </p>
               <p><code class="literal">ciphertext</code> The ciphertext to decrypt, greater than
                  <code class="literal">HashLength</code> bytes in size. </p>
               <p> Output: </p>
               <p><code class="literal">plaintext</code> The resulting plaintext. </p>
               <p> The output of LIONESS-Decrypt is calculated as follows: </p>
               <pre class="programlisting">
L = ciphertext[0:HashLength]
R = ciphertext[HashLength:]
L = L ^ H(k4, R)
R = R ^ S(L ^ k3)
L = L ^ H(k2, R)
R = R ^ S(L ^ k1)
plaintext = L | R
</pre>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both"><a name="lioness-blake2b-chacha20"></a>3. LIONESS-BLAKE2b-ChaCha20</h2>
                  </div>
               </div>
            </div>
            <p> LIONESS-BLAKE2b-ChaCha20 is a concrete parameterization of LIONESS based around the
               BLAKE2b <a class="link" href="#RFC7693">RFC7693</a> hash algorithm and ChaCha20 <a class="link" href="#RFC7539">RFC7539</a> stream cipher. It provides a security level of at
               least 256 bits, and supports a per-call initialization vector. </p>
            <p> Plaintext and Ciphertext MUST NOT exceed <code class="literal">32 + ((1 \&lt;\&lt; 32) \*
                  64)</code> bytes. </p>
            <p> For sections 3.1 and 3.2: </p>
            <p> Let <code class="literal">BLAKE2b(k, m)</code> return the BLAKE2b digest calculated with key
               <code class="literal">k</code>, and message <code class="literal">m</code>, truncated to 32 bytes. </p>
            <p> Let <code class="literal">ChaCha20(k, n, m)</code> return the ChaCha20 encrypted ciphertext
               with key <code class="literal">k</code>, nonce <code class="literal">n</code>, and message
               <code class="literal">m</code>, with the counter initialized to <code class="literal">0</code>. </p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="lioness-blake2b-chacha20-encryption"></a>3.1 LIONESS-BLAKE2b-ChaCha20 Encryption</h3>
                     </div>
                  </div>
               </div>
               <pre class="programlisting">
LIONESS-BLAKE2b-ChaCha20-Encrypt(key, iv, plaintext) -&gt; ciphertext
</pre>
               <p> Inputs: </p>
               <p><code class="literal">key</code> The key, 128 bytes in size. <code class="literal">iv</code> The
                  initialization vector, 48 bytes in size. <code class="literal">plaintext</code> The plaintext
                  to encrypt, greater than 32 bytes in size. </p>
               <p> Output: </p>
               <p><code class="literal">ciphertext</code> The resulting ciphertext. </p>
               <p> The output of LIONESS-BLAKE2b-ChaCha20-Encrypt is calculated as follows: </p>
               <pre class="programlisting">
k1 = key[0:32]
k2 = key[32:64]
k3 = key[64:96]
k4 = key[96:128]
iv1 = iv[0:12]
iv2 = iv[12:24]
iv3 = iv[24:36]
iv4 = iv[36:48]

L = ciphertext[0:32]
R = ciphertext[32:]
R = ChaCha20(L ^ k1, iv1, R)
L = L ^ BLAKE2b(k2 | iv2, R)
R = ChaCha20(L ^ k3, iv3, R)
L = L ^ BLAKE2b(k4 | iv4, R)
ciphertext = L | R
</pre>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="lioness-blake2b-chacha20-decryption"></a>3.2 LIONESS-BLAKE2b-ChaCha20 Decryption</h3>
                     </div>
                  </div>
               </div>
               <pre class="programlisting">
LIONESS-BLAKE2b-ChaCha20-Decrypt(key, iv, ciphertext) -&gt; plaintext
</pre>
               <p> Inputs: </p>
               <p><code class="literal">key</code> The key, 128 bytes in size. </p>
               <p><code class="literal">iv</code> The initialization vector, 48 bytes in size. </p>
               <p><code class="literal">ciphertext</code> The ciphertext to decrypt, greater than 32 bytes in
                  size. </p>
               <p> Output: </p>
               <p><code class="literal">plaintext</code> The resulting plaintext. </p>
               <p> The output of LIONESS-BLAKE2b-ChaCha20-Decrypt is calculated as follows: </p>
               <pre class="programlisting">
k1 = key[0:32]
k2 = key[32:64]
k3 = key[64:96]
k4 = key[96:128]
iv1 = iv[0:12]
iv2 = iv[12:24]
iv3 = iv[24:36]
iv4 = iv[36:48]

L = ciphertext[0:32]
R = ciphertext[32:]
L = L ^ BLAKE2b(k4 | iv4, R)
R = ChaCha20(L ^ k3, iv3, R)
L = L ^ BLAKE2b(k2 | iv2, R)
R = ChaCha20(L ^ k1, iv1, R)
plaintext = L | R
</pre>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both"><a name="implementation-considerations"></a>4. Implementation Considerations</h2>
                  </div>
               </div>
            </div>
            <p> When choosing the underlying stream cipher or MAC, implementors may wish to consider
               the initialization overhead such as key scheduling, as the performance impact can
               be
               non-negligible depending on algorithm choice. </p>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both"><a name="security-considerations"></a>5. Security Considerations</h2>
                  </div>
               </div>
            </div>
            <p> When parameterizing the LIONESS construct care MUST be taken to pick cryptographic
               primitives that meet the requirements specified in Section 2.1. Depending on the
               primitive chosen for <code class="literal">S()</code>, there may be a maximum block size imposed
               by the maximum amount of data that <code class="literal">S()</code> may encrypt with a given key. </p>
            <p> Care MUST be taken to avoid leaking sensitive information via side-channels, however
               this is primarily influenced by the algorithms and implementations selected for
               <code class="literal">H()</code> and <code class="literal">S()</code> than the LIONESS construct itself. </p>
            <p> No claims are made regarding the security of LIONESS when the same key material is
               used to encrypt multiple blocks, beyond those made in <a class="link" href="#MPRA11">MPRA11</a>. Conservative users may wish to avoid this behavior, use LIONESS as
               the building block for standard block cipher constructs that take initialization
               vectors, or incorporate initialization vectors in the <code class="literal">H()</code> and
               <code class="literal">S()</code> calls. </p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="appendix-a.-references"></a>Appendix A. References</h3>
                     </div>
                  </div>
               </div>
               <p><a name="AB96"></a><span class="bold"><strong>AB96</strong></span></p>
               <p>Anderson, R., Biham, E., <span class="quote">&#x201c;<span class="quote">Two Practical and Provably Secure Block Ciphers: BEAR and LION</span>&#x201d;</span>, 1996, 
                  <a class="link" href="" target="_top"></a></p>
               <p><a name="MPRA11"></a><span class="boldMPRA11"></span></p>
               <p>Maines, L., Piva, M., Rimoldi, A., Sala, M., <span class="quote">&#x201c;<span class="quote">On the provable security of BEAR and LION schemes</span>&#x201d;</span>, May 2011, arXiv:1105.0259, 
                  <a class="link" href="https://arxiv.org/abs/1105.0259" target="_top">https://arxiv.org/abs/1105.0259</a></p>
               <p><a name="RFC2119"></a><span class="bold"><strong>RFC2119</strong></span></p>
               <p>Bradner, S., <span class="quote">&#x201c;<span class="quote">Key words for use in RFCs to Indicate Requirement
                        Levels</span>&#x201d;</span>, BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, <a class="link" href="http://www.rfc-editor.org/info/rfc2119" target="_top">http://www.rfc-editor.org/info/rfc2119</a></p>
               <p><a name="RFC7539"></a><span class="bold"><strong>RFC7539</strong></span></p>
               <p>Nir, Y. and A. Langley, <span class="quote">&#x201c;<span class="quote">ChaCha20 and Poly1305 for IETF Protocols</span>&#x201d;</span>, May 2015, RFC 7539, DOI 10.17487/RFC7539, 
                  <a class="link" href="http://www.rfc-editor.org/info/rfc7539" target="_top">http://www.rfc-editor.org/info/rfc7539</a></p>
               <p><a name="RFC7693"></a><span class="bold"><strong>RFC7693</strong></span></p>
               <p>Saarinen, M-J., Ed., and J-P. Aumasson, <span class="quote">&#x201c;<span class="quote">The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)</span>&#x201d;</span>, RFC 7693, DOI 10.17487/RFC7693, November 2015, 
                  <a class="link" href="http://www.rfc-editor.org/info/rfc7693" target="_top">http://www.rfc-editor.org/info/rfc7693</a></p>
            </div>
         </div>
      </div>
   </body>
</html>